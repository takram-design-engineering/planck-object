!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],n):n(e.Planck=e.Planck||{},e.THREE)}(this,function(e,n){"use strict";function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=Symbol(e);return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return void 0===e[n]&&(e[n]=t({})),e[n]}}function i(e){var n=k(e);return{set target(e){n.target=void 0!==e?e:null},set currentTarget(e){n.currentTarget=void 0!==e?e:null},set eventPhase(e){n.eventPhase=void 0!==e?e:null}}}function r(e,n){if("function"==typeof n)n(e);else{if("function"!=typeof n.handleEvent)throw new Error("Listener is neither function nor event listener");n.handleEvent(e)}}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=(function(){function e(e){this.value=e}function n(n){function t(r,a){try{var o=n[r](a),s=o.value;s instanceof e?Promise.resolve(s.value).then(function(e){t("next",e)},function(e){t("throw",e)}):i(o.done?"return":"normal",o.value)}catch(e){i("throw",e)}}function i(e,n){switch(e){case"return":r.resolve({value:n,done:!0});break;case"throw":r.reject(n);break;default:r.resolve({value:n,done:!1})}(r=r.next)?t(r.key,r.arg):a=null}var r,a;this._invoke=function(e,n){return new Promise(function(i,o){var s={key:e,arg:n,resolve:i,reject:o,next:null};a?a=a.next=s:(r=a=s,t(e,n))})},"function"!=typeof n.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}),s=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},c=function e(n,t,i){null===n&&(n=Function.prototype);var r=Object.getOwnPropertyDescriptor(n,t);if(void 0===r){var a=Object.getPrototypeOf(n);return null===a?void 0:e(a,t,i)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(i)},p=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)},d=function(e,n){var t={};for(var i in e)n.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},u=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n},h=function e(n,t,i,r){var a=Object.getOwnPropertyDescriptor(n,t);if(void 0===a){var o=Object.getPrototypeOf(n);null!==o&&e(o,t,i,r)}else if("value"in a&&a.writable)a.value=i;else{var s=a.set;void 0!==s&&s.call(r,i)}return i},g=function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)},f=Symbol("_cachedApplicationRef"),_=Symbol("_mixinRef"),v=Symbol("_originalMixin"),m=function(e,n){return Object.setPrototypeOf(n,e),e[v]||(e[v]=e),n},y=function(e){return m(e,function(n){var t=e[f];if(t||(t=e[f]=Symbol(e.name)),n.hasOwnProperty(t))return n[t];var i=e(n);return n[t]=i,i})},b=function(e){return Symbol.hasInstance&&!e.hasOwnProperty(Symbol.hasInstance)&&Object.defineProperty(e,Symbol.hasInstance,{value:function(e){for(var n=this[v];null!=e;){if(e.hasOwnProperty(_)&&e[_]===n)return!0;e=Object.getPrototypeOf(e)}return!1}}),e},L=function(e){return m(e,function(n){var t=e(n);return t.prototype[_]=e[v],t})},C=function(e){return y(b(L(e)))},x=function(e){return new S(e)},S=function(){function e(n){o(this,e),this.superclass=n}return s(e,[{key:"with",value:function(){return Array.from(arguments).reduce(function(e,n){return n(e)},this.superclass)}}]),e}(),T=function(){try{if(new Function("return this === window")())return"browser"}catch(e){}try{if(new Function("return this === self")())return"worker"}catch(e){}try{if(new Function("return this === global")())return"node"}catch(e){}}(),P=void 0;switch(T){case"browser":P=window;break;case"worker":P=self;break;case"node":P=global}var M={type:T,self:P},k=t("Event"),w=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.init(n)}return s(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.type,t=e.captures,i=void 0!==t&&t,r=e.bubbles,a=void 0===r||r,o=e.cancelable,s=void 0===o||o,l=k(this);return l.type=void 0!==n?n:null,l.captures=!!i,l.bubbles=!!a,l.cancelable=!!s,l.timeStamp=M.self.performance&&M.self.performance.now&&M.self.performance.now()||Date.now(),l.propagationStopped=!1,l.immediatePropagationStopped=!1,l.defaultPrevented=!1,l.target=null,l.currentTarget=null,l.eventPhase=null,this}},{key:"stopPropagation",value:function(){k(this).propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){var e=k(this);e.propagationStopped=!0,e.immediatePropagationStopped=!0}},{key:"preventDefault",value:function(){this.cancelable&&(k(this).defaultPrevented=!0)}},{key:"type",get:function(){return k(this).type}},{key:"target",get:function(){return k(this).target}},{key:"currentTarget",get:function(){return k(this).currentTarget}},{key:"eventPhase",get:function(){return k(this).eventPhase}},{key:"captures",get:function(){return k(this).captures}},{key:"bubbles",get:function(){return k(this).bubbles}},{key:"cancelable",get:function(){return k(this).cancelable}},{key:"timeStamp",get:function(){return k(this).timeStamp}},{key:"propagationStopped",get:function(){return k(this).propagationStopped}},{key:"immediatePropagationStopped",get:function(){return k(this).immediatePropagationStopped}},{key:"defaultPrevented",get:function(){return k(this).defaultPrevented}}]),e}(),I=function(e){function n(){return o(this,n),u(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return p(n,w),s(n,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.target,a=d(e,["type","target"]);return c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"init",this).call(this,l({type:t},a)),i(this).target=void 0!==r?r:null,this}}]),n}(),O=function(e){function n(){return o(this,n),u(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return p(n,I),s(n,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,i=e.target,r=e.captures,a=void 0!==r&&r,o=e.bubbles,s=void 0!==o&&o,l=d(e,["type","target","captures","bubbles"]);c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"init",this).call(this,{type:t,target:i,captures:a,bubbles:s});for(var p=Object.keys(l),u=0;u<p.length;++u){var h=p[u];if({}.hasOwnProperty.call(this,h))throw new Error('Name "'+h+'" cannot be used for event property');this[h]=l[h]}return this}}]),n}(),j=t("EventDispatcherMixin"),F=C(function(e){return function(n){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return j(a).listeners={},a}return p(t,e),s(t,[{key:"addEventListener",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("function"!=typeof n&&"object"!==(void 0===n?"undefined":a(n)))throw new Error("Attempt to add non-function non-object listener");var i=j(this);void 0===i.listeners[e]&&(i.listeners[e]={bubble:[],capture:[]});var r=t?i.listeners[e].capture:i.listeners[e].bubble;r.includes(n)||r.push(n)}},{key:"removeEventListener",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=j(this);if(void 0!==i.listeners[e]){var r=t?i.listeners[e].capture:i.listeners[e].bubble,a=r.indexOf(n);-1!==a&&r.splice(a,1)}}},{key:"on",value:function(){return this.addEventListener.apply(this,arguments),this}},{key:"off",value:function(){return this.removeEventListener.apply(this,arguments),this}},{key:"once",value:function(e,n){for(var t=arguments.length,i=Array(t>2?t-2:0),a=2;a<t;a++)i[a-2]=arguments[a];var o=this,s=function t(a){r(a,n),o.removeEventListener.apply(o,[e,t].concat(i))};return this.addEventListener.apply(this,[e,s].concat(i)),this}},{key:"dispatchEvent",value:function(e){var n=e;n instanceof w||(n=new O(e));var t=i(n);null===n.target&&(t.target=this),t.currentTarget=this;var a=j(this).listeners[n.type];if(void 0!==a){var o=n.eventPhase;if(!o||"target"===o||"capture"===o)for(var s=0;s<a.capture.length;++s)if(r(n,a.capture[s]),n.immediatePropagationStopped)return;if(!o||"target"===o||"bubble"===o)for(var l=0;l<a.bubble.length;++l)if(r(n,a.bubble[l]),n.immediatePropagationStopped)return}}}]),t}()}),E=t("EventTargetMixin"),D=C(function(e){return function(n){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),s=E(a);return s.ancestorEventTarget=null,s.descendantEventTarget=null,a}return p(t,e),s(t,[{key:"determinePropagationPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=[];if(null!==e&&void 0!==e)for(var t=e;null!==t&&void 0!==t&&(n.unshift(t),t=t.ancestorEventTarget,!n.includes(t)););else for(var i=this;null!==i&&void 0!==i&&(n.push(i),i=i.descendantEventTarget,!n.includes(i)););return n}},{key:"dispatchImmediateEvent",value:function(e){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispatchEvent",this).call(this,e)}},{key:"dispatchEvent",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=e;t instanceof w||(t=new O(e));var r=i(t);if(t.captures||t.bubbles){var a=void 0;if(a=Array.isArray(n)?[].concat(g(n)):this.determinePropagationPath(t.target||this),null===t.target?r.target=a.pop():a.pop(),t.captures){r.eventPhase="capture";for(var o=0;o<a.length;++o)if(a[o].dispatchImmediateEvent(t),t.propagationStopped)return}if((Number.isInteger(t.target)||(r.eventPhase="target",t.target.dispatchImmediateEvent(t),!t.propagationStopped))&&t.bubbles){r.eventPhase="bubble";for(var s=a.length-1;s>=0;--s)if(a[s].dispatchImmediateEvent(t),t.propagationStopped)return}}else this.dispatchImmediateEvent(t)}},{key:"ancestorEventTarget",get:function(){return E(this).ancestorEventTarget},set:function(e){E(this).ancestorEventTarget=void 0!==e?e:null}},{key:"descendantEventTarget",get:function(){return E(this).descendantEventTarget},set:function(e){E(this).descendantEventTarget=void 0!==e?e:null}}]),t}()}),G=t("SceneGraphMixin"),R=C(function(e){return function(t){function i(){var e;o(this,i);for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];var a=u(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(t))),s=G(a);return s.setup=!1,s.disposed=!1,s.scene=null,a}return p(i,e),s(i,[{key:"setup",value:function(){G(this).setup=!0}},{key:"dispose",value:function(){this.parent&&this.parent.remove(this)}},{key:"addedToParent",value:function(e){var t=G(this);t.setup||(this.setup(),t.setup=!0),e instanceof n.Scene?(this.addedToScene(e),this.dispatchEvent({type:"addedToScene",scene:e})):null!==e&&null!==e.scene&&(this.addedToScene(e.scene),this.dispatchEvent({type:"addedToScene",scene:e.scene}))}},{key:"addedToScene",value:function(e){G(this).scene=e;for(var n=0;n<this.children.length;++n){var t=this.children[n];t.addedToScene(e),t.dispatchEvent({type:"addedToScene",scene:e})}}},{key:"removedFromParent",value:function(e){G(this).scene=null,e instanceof n.Scene?(this.removedFromScene(e),this.dispatchEvent({type:"removedFromScene",scene:e})):null!==e&&null!==e.scene&&(this.removedFromScene(e.scene),this.dispatchEvent({type:"removedFromScene",scene:e.scene}))}},{key:"removedFromScene",value:function(e){for(var n=0;n<this.children.length;++n){var t=this.children[n];t.removedFromScene(e),t.dispatchEvent({type:"removedFromScene",scene:e})}}},{key:"dispatchEvent",value:function(e){var n;if("added"===e.type&&!e.to){var t=G(this);return this.addedToParent(this.parent),c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dispatchEvent",this).call(this,{type:"added",parent:this.parent}),c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dispatchEvent",this).call(this,{type:"addedToParent",parent:this.parent}),void(t.parent=this.parent)}if("removed"===e.type&&!e.from){var r=G(this);return this.removedFromParent(r.parent),c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dispatchEvent",this).call(this,{type:"removed",parent:r.parent}),c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dispatchEvent",this).call(this,{type:"removedFromParent",parent:r.parent}),void delete r.parent}for(var a=arguments.length,o=Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];(n=c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dispatchEvent",this)).call.apply(n,[this,e].concat(o))}},{key:"ancestorEventTarget",get:function(){return this.parent||c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"ancestorEventTarget",this)},set:function(e){h(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"ancestorEventTarget",e,this)}},{key:"scene",get:function(){return G(this).scene}}]),i}()}),A=function(e){function n(){return o(this,n),u(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return p(n,e),n}(x(n.Group).with(F,D,R)),Y={depth_frag_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// depth_frag.glsl\n\n#include <clipping_planes_fragment>\n\nvec4 diffuseColor = vec4(1.0);\n\n#if DEPTH_PACKING == 3200\n  diffuseColor.a = opacity;\n#endif\n",depth_frag_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// depth_frag.glsl\n\n#include <map_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <logdepthbuf_fragment>\n\n#if DEPTH_PACKING == 3200\n  gl_FragColor = vec4(vec3(gl_FragCoord.z), opacity);\n#elif DEPTH_PACKING == 3201\n  gl_FragColor = packDepthToRGBA(gl_FragCoord.z);\n#endif\n",depth_frag_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// depth_frag.glsl\n\n#if DEPTH_PACKING == 3200\n  uniform float opacity;\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n",depth_vert_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// depth_vert.glsl\n\n#include <uv_vertex>\n#include <skinbase_vertex>\n#ifdef USE_DISPLACEMENTMAP\n  #include <beginnormal_vertex>\n  #include <morphnormal_vertex>\n  #include <skinnormal_vertex>\n#endif\n#include <begin_vertex>\n",depth_vert_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// depth_vert.glsl\n\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n",depth_vert_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// depth_vert.glsl\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n",distance_frag_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// distanceRGBA_frag.glsl\n\n#include <clipping_planes_fragment>\n\nvec4 diffuseColor = vec4(1.0);\n\n#include <map_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n\nfloat dist = length(vWorldPosition - referencePosition);\ndist = (dist - nearDistance) / (farDistance - nearDistance);\ndist = saturate(dist); // clamp to [0, 1]\n",distance_frag_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// distanceRGBA_frag.glsl\n\ngl_FragColor = packDepthToRGBA(dist);\n",distance_frag_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// distanceRGBA_frag.glsl\n\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n",distance_vert_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// distanceRGBA_vert.glsl\n\n#include <uv_vertex>\n#include <skinbase_vertex>\n#ifdef USE_DISPLACEMENTMAP\n  #include <beginnormal_vertex>\n  #include <morphnormal_vertex>\n  #include <skinnormal_vertex>\n#endif\n#include <begin_vertex>\n",distance_vert_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// distanceRGBA_vert.glsl\n\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <worldpos_vertex>\n#include <clipping_planes_vertex>\n\nvWorldPosition = worldPosition.xyz;\n",distance_vert_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// distanceRGBA_vert.glsl\n\n#define DISTANCE\n\nvarying vec4 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n",line_basic_frag_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// linedashed_frag.glsl\n\n#include <clipping_planes_fragment>\n\nvec3 outgoingLight = vec3(0.0);\nvec4 diffuseColor = vec4(diffuse, opacity);\n",line_basic_frag_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// linedashed_frag.glsl\n\n#include <logdepthbuf_fragment>\n#include <color_fragment>\n\noutgoingLight = diffuseColor.rgb; // simple shader\n\ngl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n#include <premultiplied_alpha_fragment>\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n",line_basic_frag_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// linedashed_frag.glsl\n\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n",line_basic_vert_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// linedashed_vert.glsl\n\n#include <color_vertex>\n#include <begin_vertex>\n",line_basic_vert_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// linedashed_vert.glsl\n\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n",line_basic_vert_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// linedashed_vert.glsl\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n",mesh_lambert_frag_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// meshlambert_frag.glsl\n\n#include <clipping_planes_fragment>\n\nvec4 diffuseColor = vec4(diffuse, opacity);\nReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\nvec3 totalEmissiveRadiance = emissive;\n",mesh_lambert_frag_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// meshlambert_frag.glsl\n\n#include <logdepthbuf_fragment>\n#include <map_fragment>\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <specularmap_fragment>\n#include <emissivemap_fragment>\n\n// accumulation\nreflectedLight.indirectDiffuse = getAmbientLightIrradiance(ambientLightColor);\n\n#include <lightmap_fragment>\n\nreflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert(diffuseColor.rgb);\n\n#ifdef DOUBLE_SIDED\n  reflectedLight.directDiffuse = (gl_FrontFacing) ? vLightFront : vLightBack;\n#else\n  reflectedLight.directDiffuse = vLightFront;\n#endif\n\nreflectedLight.directDiffuse *= BRDF_Diffuse_Lambert(diffuseColor.rgb) * getShadowMask();\n\n// modulation\n#include <aomap_fragment>\n\nvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n#include <envmap_fragment>\n\ngl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n#include <dithering_fragment>\n",mesh_lambert_frag_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// meshlambert_frag.glsl\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n  varying vec3 vLightBack;\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n",mesh_lambert_vert_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// meshlambert_vert.glsl\n\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#include <begin_vertex>\n",mesh_lambert_vert_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// meshlambert_vert.glsl\n\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#include <worldpos_vertex>\n#include <envmap_vertex>\n#include <lights_lambert_vertex>\n#include <shadowmap_vertex>\n#include <fog_vertex>\n",mesh_lambert_vert_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// meshlambert_vert.glsl\n\n#define LAMBERT\n\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n  varying vec3 vLightBack;\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n",picking_frag_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <clipping_planes_fragment>\n\ngl_FragColor = identifier;\n",picking_frag_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <logdepthbuf_fragment>\n",picking_frag_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\nuniform vec4 identifier;\n\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n",picking_vert_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <skinbase_vertex>\n#include <begin_vertex>\n",picking_vert_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <worldpos_vertex>\n#include <clipping_planes_vertex>\n",picking_vert_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n",points_frag_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// points_frag.glsl\n\n#include <clipping_planes_fragment>\n\nvec3 outgoingLight = vec3(0.0);\nvec4 diffuseColor = vec4(diffuse, opacity);\n",points_frag_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// points_frag.glsl\n\n#include <logdepthbuf_fragment>\n#include <map_particle_fragment>\n#include <color_fragment>\n#include <alphatest_fragment>\n\noutgoingLight = diffuseColor.rgb;\n\ngl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n#include <premultiplied_alpha_fragment>\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n",points_frag_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// points_frag.glsl\n\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n",points_picking_frag_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <clipping_planes_fragment>\n\ngl_FragColor = vVertexID;\n",points_picking_frag_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <logdepthbuf_fragment>\n",points_picking_frag_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec4 vVertexID;\n",points_picking_vert_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <begin_vertex>\n",points_picking_vert_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <project_vertex>\n\n#ifdef USE_SIZEATTENUATION\n  gl_PointSize = size * (scale / -mvPosition.z);\n#else\n  gl_PointSize = size;\n#endif\n\n{\n  // Add 1 to distinguish points draw or not\n  vec4 v = decomposeVertexID(vertexID + 1.0);\n  vVertexID = addVertexID(identifier, v) / 255.0;\n}\n\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#include <worldpos_vertex>\n",points_picking_vert_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform vec4 identifier;\n\nattribute float vertexID;\n\nvarying vec4 vVertexID;\n\nvec4 decomposeVertexID(float v) {\n  float x = floor(v / 16777216.0);\n  v -= x * 16777216.0;\n  float y = floor(v / 65536.0);\n  v -= y * 65536.0;\n  float z = floor(v / 256.0);\n  v -= z * 256.0;\n  return vec4(x, y, z, v);\n}\n\nvec4 addVertexID(vec4 v, vec4 id) {\n  vec4 r = floor(v * 255.0 + 0.5) + id;\n  r.z += floor(r.w / 256.0);\n  r.y += floor(r.z / 256.0);\n  r.x += floor(r.y / 256.0);\n  return mod(r, 256.0);\n}\n",points_vert_begin:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// points_vert.glsl\n\n#include <color_vertex>\n#include <begin_vertex>\n",points_vert_end:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// points_vert.glsl\n\n#include <project_vertex>\n\n#ifdef USE_SIZEATTENUATION\n  gl_PointSize = size * (scale / -mvPosition.z);\n#else\n  gl_PointSize = size;\n#endif\n\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#include <worldpos_vertex>\n#include <shadowmap_vertex>\n#include <fog_vertex>\n",points_vert_params:"#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2010-2017 three.js authors\n// Copyright (C) 2016-Present Shota Matsuda\n\n// r87\n// points_vert.glsl\n\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n"},B={include:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"planck/",i=new RegExp("#include +<"+t+"([\\w\\d.]+)>","g");return e.replace(i,function e(r,a){var o=n[a];if(void 0===o)throw new Error("Could not resolve #include <"+t+a+">");return o.replace(i,e)})}},z="#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <planck/line_basic_frag_params>\n\nuniform float pixelRatio;\nuniform float targetPixelRatio;\n\nvoid main() {\n  #include <planck/line_basic_frag_begin>\n\n  diffuseColor.a *= pixelRatio / targetPixelRatio;\n\n  #include <planck/line_basic_frag_end>\n}\n",N="#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <planck/line_basic_vert_params>\n\nvoid main() {\n  #include <planck/line_basic_vert_begin>\n  #include <planck/line_basic_vert_end>\n}\n",U=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var i=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i.color=new n.Color(16777215);var r=new n.LineBasicMaterial;return n.LineBasicMaterial.prototype.copy.call(i,r),r.dispose(),i.setValues(e),i.isLineBasicMaterial=!0,i.uniforms=n.UniformsUtils.merge([n.UniformsLib.common,n.UniformsLib.fog,{pixelRatio:{value:1},targetPixelRatio:{value:2}}]),i.vertexShader=B.include(N),i.fragmentShader=B.include(z),i}return p(t,e),t}(n.ShaderMaterial),H=function(e){function n(e,t){o(this,n);var i=u(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t||new U));return i.material&&(i.customDepthMaterial=i.material.customDepthMaterial,i.customDistanceMaterial=i.material.customDistanceMaterial,i.customPickingMaterial=i.material.customPickingMaterial),i}return p(n,e),n}(x(n.Line).with(F,D,R)),V=function(e){function n(e,t){o(this,n);var i=u(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t||new U));return i.material&&(i.customDepthMaterial=i.material.customDepthMaterial,i.customDistanceMaterial=i.material.customDistanceMaterial,i.customPickingMaterial=i.material.customPickingMaterial),i}return p(n,e),n}(x(n.LineLoop).with(F,D,R)),W=function(e){function n(e,t){o(this,n);var i=u(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t||new U));return i.material&&(i.customDepthMaterial=i.material.customDepthMaterial,i.customDistanceMaterial=i.material.customDistanceMaterial,i.customPickingMaterial=i.material.customPickingMaterial),i}return p(n,e),n}(x(n.LineSegments).with(F,D,R)),K=function(e){function t(e,i){o(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i||new n.MeshLambertMaterial));return r.castShadow=!0,r.receiveShadow=!0,r.material&&(r.customDepthMaterial=r.material.customDepthMaterial,r.customDistanceMaterial=r.material.customDistanceMaterial,r.customPickingMaterial=r.material.customPickingMaterial),r}return p(t,e),t}(x(n.Mesh).with(F,D,R)),q=function(e){function n(){return o(this,n),u(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return p(n,e),n}(x(n.Object3D).with(F,D,R)),Z="#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <planck/points_frag_params>\n\nvoid main() {\n  #include <planck/points_frag_begin>\n  #include <planck/points_frag_end>\n}\n",J="#define GLSLIFY 1\n// The MIT License\n// Copyright (C) 2016-Present Shota Matsuda\n\n#include <planck/points_vert_params>\n\nvoid main() {\n  #include <planck/points_vert_begin>\n  #include <planck/points_vert_end>\n}\n",Q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var i=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i.color=new n.Color(16777215);var r=new n.PointsMaterial;return n.PointsMaterial.prototype.copy.call(i,r),r.dispose(),i.setValues(e),i.isPointsMaterial=!0,i.uniforms=n.UniformsUtils.merge([n.ShaderLib.points.uniforms]),i.vertexShader=B.include(J),i.fragmentShader=B.include(Z),i}return p(t,e),t}(n.ShaderMaterial),X=function(e){function n(e,t){o(this,n);var i=u(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t||new Q));return i.material&&(i.customDepthMaterial=i.material.customDepthMaterial,i.customDistanceMaterial=i.material.customDistanceMaterial,i.customPickingMaterial=i.material.customPickingMaterial),i}return p(n,e),s(n,[{key:"identifierLength",get:function(){var e=this.geometry.getAttribute("position");return e?e.count+1:c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"identifierLength",this)}}]),n}(x(n.Points).with(F,D,R)),$=function(e){function t(e){o(this,t);var i=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.material&&(i.customDepthMaterial=i.material.customDepthMaterial,i.customDistanceMaterial=i.material.customDistanceMaterial,i.customPickingMaterial=i.material.customPickingMaterial),i.size=new n.Vector2,i}return p(t,e),s(t,[{key:"onBeforeRender",value:function(e,n,t,i,r,a){var o=1/t.zoom,s=this.size.x*o,l=this.size.y*o;this.scale.x===s&&this.scale.y===l||(this.scale.set(this.size.x*o,this.size.y*o,1),this.updateMatrixWorld())}}]),t}(x(n.Sprite).with(F,D,R)),ee=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.color="white",this.backgroundColor="transparent",this.fontSize=10,this.fontFamily="sans-serif",this.fontWeight="normal",this.lineHeight=1,this.letterSpacing=0,this.textTransform="uppercase",this.textAlign="center",this.verticalAlign="middle";for(var t=Object.keys(n),i=0;i<t.length;++i){var r=t[i];({}).hasOwnProperty.call(this,r)&&(this[r]=n[r])}void 0===n.marginTop?this.marginTop=n.margin||0:this.marginTop=n.marginTop,void 0===n.marginRight?this.marginRight=n.margin||0:this.marginRight=n.marginRight,void 0===n.marginBottom?this.marginBottom=n.margin||0:this.marginBottom=n.marginBottom,void 0===n.marginLeft?this.marginLeft=n.margin||0:this.marginLeft=n.marginLeft,void 0===n.paddingTop?this.paddingTop=n.padding||0:this.paddingTop=n.paddingTop,void 0===n.paddingRight?this.paddingRight=n.padding||0:this.paddingRight=n.paddingRight,void 0===n.paddingBottom?this.paddingBottom=n.padding||0:this.paddingBottom=n.paddingBottom,void 0===n.paddingLeft?this.paddingLeft=n.padding||0:this.paddingLeft=n.paddingLeft}return s(e,[{key:"copy",value:function(e){return this.color=e.color,this.backgroundColor=e.backgroundColor,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.fontWeight=e.fontWeight,this.lineHeight=e.lineHeight,this.letterSpacing=e.letterSpacing,this.textTransform=e.textTransform,this.textAlign=e.textAlign,this.verticalAlign=e.verticalAlign,this.marginTop=e.marginTop,this.marginRight=e.marginRight,this.marginBottom=e.marginBottom,this.marginLeft=e.marginLeft,this.paddingTop=e.paddingTop,this.paddingRight=e.paddingRight,this.paddingBottom=e.paddingBottom,this.paddingLeft=e.paddingLeft,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"equals",value:function(e){return this.color===e.color&&this.backgroundColor===e.backgroundColor&&this.fontSize===e.fontSize&&this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.textTransform===e.textTransform&&this.textAlign===e.textAlign&&this.verticalAlign===e.verticalAlign&&this.marginTop===e.marginTop&&this.marginRight===e.marginRight&&this.marginBottom===e.marginBottom&&this.marginLeft===e.marginLeft&&this.paddingTop===e.paddingTop&&this.paddingRight===e.paddingRight&&this.paddingBottom===e.paddingBottom&&this.paddingLeft===e.paddingLeft}},{key:"font",get:function(){return this.fontWeight+" "+this.fontSize+"px "+this.fontFamily}},{key:"margin",set:function(e){this.marginTop=e,this.marginRight=e,this.marginBottom=e,this.marginLeft=e}},{key:"padding",set:function(e){this.paddingTop=e,this.paddingRight=e,this.paddingBottom=e,this.paddingLeft=e}}]),e}(),ne=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.text,r=e.style,a=e.pixelRatio;o(this,t);var s=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,new n.SpriteMaterial));return s.text=i||"",s.style=new ee(r),s.pixelRatio=a||window.devicePixelRatio,s.canvas=document.createElement("canvas"),s.material.transparent=!0,s.material.map=new n.CanvasTexture(s.canvas,void 0,void 0,void 0,n.NearestFilter,n.NearestFilter),s.draw(),s}return p(t,$),s(t,[{key:"draw",value:function(){var e=this.canvas.getContext("2d"),t=this.style,i=this.text.toString().split("\n"),r=this.measureLines(i,this.style),a=this.style,o=a.marginTop,s=a.marginRight,c=a.marginBottom,p=a.marginLeft,d=a.paddingTop,u=a.paddingRight,h=a.paddingBottom,g=a.paddingLeft,f=a.textAlign,_=a.verticalAlign;r.width+=g+u,r.height+=d+h;var v=l({},r);r.width+=p+s,r.height+=o+c;var m=r.width*this.pixelRatio,y=r.height*this.pixelRatio,b=this.pixelRatio;this.canvas.width=n.Math.nextPowerOfTwo(m+2*b),this.canvas.height=n.Math.nextPowerOfTwo(y+2*b);var L=(this.canvas.width-m)/2,C=(this.canvas.height-y)/2;switch(e.save(),e.translate(L,C),e.scale(b,b),f){case"left":case"right":e.translate(p,0);break;case"center":default:e.translate((p+s)/2,0)}switch(_){case"top":case"bottom":e.translate(0,o);break;case"middle":default:e.translate(0,(o+c)/2)}switch(this.drawBackground(v,t),this.drawLines(i,v,t),e.restore(),f){case"left":this.size.x=2*r.width,this.material.map.offset.x=(L-m)/this.canvas.width,this.material.map.repeat.x=m/this.canvas.width*2;break;case"right":this.size.x=2*r.width,this.material.map.offset.x=L/this.canvas.width,this.material.map.repeat.x=m/this.canvas.width*2;break;case"center":default:this.size.x=r.width,this.material.map.offset.x=L/this.canvas.width,this.material.map.repeat.x=m/this.canvas.width}switch(_){case"top":this.size.y=2*r.height,this.material.map.offset.y=C/this.canvas.height,this.material.map.repeat.y=y/this.canvas.height*2;break;case"bottom":this.size.y=2*r.height,this.material.map.offset.y=(C-y)/this.canvas.height,this.material.map.repeat.y=y/this.canvas.height*2;break;case"middle":default:this.size.y=r.height,this.material.map.offset.y=C/this.canvas.height,this.material.map.repeat.y=y/this.canvas.height}this.material.map.needsUpdate=!0}},{key:"drawBackground",value:function(e,n){if("transparent"!==n.backgroundColor){var t=this.canvas.getContext("2d");t.save(),t.fillStyle=n.backgroundColor,t.fillRect(0,0,e.width,e.height),t.restore()}}},{key:"drawLines",value:function(e,n,t){var i=this.canvas.getContext("2d");i.save(),i.font=t.font,i.textAlign=t.textAlign,i.fillStyle=t.color,i.textBaseline="bottom";var r=0;switch(t.textAlign){case"left":r=t.paddingLeft;break;case"right":r=n.width-t.paddingRight;break;case"center":default:r=(t.paddingLeft+n.width-t.paddingRight)/2}for(var a=t.fontSize*t.lineHeight,o=.5*(a+t.fontSize)+t.paddingTop,s=0;s<e.length;++s)i.fillText(e[s],r,o),o+=a;"transparent"===t.backgroundColor&&(i.globalCompositeOperation="source-in",i.fillStyle=t.color,i.fillRect(0,0,n.width,n.height)),i.restore()}},{key:"measureLines",value:function(e,n){var t=this.canvas.getContext("2d");t.save(),t.font=n.font;for(var i=n.fontSize*n.lineHeight*e.length,r=0,a=0;a<e.length;++a){var o=t.measureText(e[a]).width;o>r&&(r=o)}return t.restore(),{width:r,height:i}}}]),t}();e.Group=A,e.Line=H,e.LineLoop=V,e.LineSegments=W,e.Mesh=K,e.Object3D=q,e.Points=X,e.SceneGraphMixin=R,e.Sprite=$,e.Text=ne,e.TextStyle=ee,Object.defineProperty(e,"__esModule",{value:!0})});